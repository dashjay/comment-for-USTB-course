### 什么是二次剩余？

$x^2 \equiv a \pmod p$ 有解，称 a 为模 p 的二次剩余

列表

| x(p=5)       | 1,4  | 2,3  |
| ------------ | ---- | ---- |
| $x^2$ 的余数 | 1    | 4    |



### 二次剩余的性质？

a 是模 p 二次剩余的充要条件 ：$a^{\frac{p-1}{2}} \equiv 1 \pmod p$ 

反之：不是的充要条件即为：$a^{\frac{p-1}{2}} \equiv -1 \pmod p$ 



#### 解数？

$a^{\frac{p-1}{2}} \equiv 1 \pmod p$  的解一共 $\frac{p-1}{2}$ 个，相反$a^{\frac{p-1}{2}} \equiv -1 \pmod p$ 的解一共 $\frac{p-1}{2}$ 个。二次剩余和非剩余刚好分别有  $\frac{p-1}{2}$ 个 



#### 勒让德符号

对于给定奇素数p，对于整数n
$$
(\frac{n}{p})=\begin{cases}
0, \ p|n; \\
1, \ n 是 p 的二次剩余; \\
-1, \ n 是 p 的非二次剩余
\end{cases}
$$
例如
$$
(\frac{1}{5})=1; \ \  (\frac{2}{5})=1 \ \ \cdots
$$
#### 勒让德符号的性质

- $n_1 \equiv n_2 \pmod p$ 则，$(\frac{n_1}{p})=(\frac{n_2}{p})$
- 如果 $p\not|\  n$ 则$(\frac{n^2}{p})=1$
- $(\frac{1}{p})=1,\ \ (\frac{-1}{p})=(-1)^{\frac{p-1}{2}} $
- 同余方程的 $x^2 \equiv n \pmod p$ 的解数为 $1 + \frac{n}{P}$
- $(\frac{mn}{p})=(\frac{m}{p})(\frac{n}{p})$
- $(\frac{2}{p})=(-1)^{\frac{p^2-1}{8}}$



#### 勒让德符号定理

二次互反定律，p, q都是奇素数：

- $(\frac{p}{q})=(-1)^{\frac{p-1}{2} \cdot \frac{q-1}{2}} \cdot (\frac{q}{p})$

#### 例子：

**判断同余方程 $x^2 \equiv (-1) \pmod {137}$ 是否有解**

$(\frac{-1}{137}) = (-1)^{\frac{137-1}{2}}=1$ ，方程有解



**判断同余方程 $x^2 \equiv 2 \pmod {227}$ 是否有解**

$(\frac{2}{227})=(-1)^{\frac{227^2-1}{8}}=-1$ 方程无解



**求$(\frac{137}{227})$**

解：
$$
原式=(\frac{-90}{227})=(\frac{-1}{227})(\frac{2 \cdot 3^2 \cdot 5}{237}) \\ 
=(-1)(\frac{2}{227}(\frac{3^2}{227})(\frac{5}{227}) \\
= -(\frac{2}{227})(\frac{5}{227})=(-1)\cdot(-1)^{\frac{227^2-1}{8}}(\frac{227}{5})=(\frac{2}{5})=-1
$$


#### 

**求$(\frac{12}{47})$**

解：
$$
=(\frac{3}{47})(\frac{4}{47}) \\
= (-1)^{\frac{3-1}{2}\cdot\frac{47-1}{2}}(\frac{3}{47})\\
= (-1)^{\frac{3-1}{2}}\\
= 1
$$
**求$(\frac{28}{53})$**

解：
$$
(\frac{28}{53}) \\
=(\frac{2}{53})(\frac{2}{53}\frac{7}{53}) \\
=(-1)^{\frac{1}{8}\cdot(53^2-1)}(-1)^{\frac{1}{8}\cdot(53^2-1)}(\frac{7}{53})  \\
=(\frac{7}{53}) \\
=(-1)^{\frac{7-1}{2}\cdot \frac{53-1}{2}}(\frac{53}{7})=1
$$


**求$(\frac{71}{73})$**
$$
=(\frac{-1}{73})(\frac{2}{73}) \\ 
=(-1)^{\frac{73-1}{2}}\cdot(-1)^{\frac{73^2-1}{8}}\\
=1
$$




**求所有奇素数 $p \not =3$，它以 3 为 2次剩余**

$(\frac{3}{p})=(\frac{p}{3})(-1)^{\frac{p-1}{2}}$ （3 是否是 p 的二次剩余，决定条件）

$(\frac{p}{3})=\begin{cases} 1, \ p \equiv 1 \pmod 3 \\ -1, \ p \equiv 2 \pmod 3\end{cases}$ （p 是否是 3 的二次剩余，决定条件）

$(-1)^{\frac{p-1}{2}} = \begin{cases} 1, \ p \equiv 1 \pmod  4 \\ -1, p \equiv 3 \pmod 4\end{cases}$（判断 $x^2 \equiv (-1) \pmod {p}$ 是否有解）

当且仅当 $(\frac{p}{3})$ 与 $(-1)^{\frac{p-1}{2}}$ 同符号时，$(\frac{3}{p})$ 为1

$\begin{cases} p \equiv 1 \pmod 3 \\ p \equiv 1 \pmod 4 \\ p \equiv -1 \pmod 3  \\p \equiv -1 \pmod4 \end{cases}$

解得 $p \equiv \pm  1 \pmod {12} $



#### 雅各布（Jacobi）符号

m 为正奇数，$\frac{n}{m}$ 是雅各布符号，当 m 又为素数时，等价于勒让德符号

-  $(\frac{-1}{m})=(-1)^{\frac{m-1}{2}}$
- $(\frac{2}{m})=(-1)^{\frac{m^2-1}{8}}$



例：判断二次方程同余方程是否有解

（1）$x^2 \equiv 5 \pmod {227}$ 

解：$(\frac{5}{227}) = (-1)^{\frac{226}{2}\frac{4}{2}} \cdot (\frac{227}{5})$

$=(\frac{2}{5})=(-1)^{\frac{5^2-1}{8}}=-1$

**无解**

（2）$x^2 \equiv 11 \pmod {511}$

解：$(\frac{11}{511})=(-\frac{500}{511})=(\frac{-1}{511})(\frac{5^2}{511})(\frac{5}{511})(\frac{2^2}{511})$

$=(-1)^{\frac{511-1}{2}}(\frac{5}{511})$

$=(-1)(-1)^{\frac{4}{2}\frac{510}{2}}\frac{511}{5} = (-1)(\frac{1}{5})=(-1)(-1)^{\frac{5-1}{2}}=-1$

**无解**

（3）$11x^2\equiv-1\pmod {91}$

解：
$$
\begin{cases}
11x^2 \equiv 1 \pmod{17} \\
11x^2 \equiv -6 \pmod {13} 
\end{cases} \\
(\frac{2}{7})=(-1)^{\frac{7^2-1}{8}}=1 \\
(\frac{3}{13}) =(-1)^{\frac{3-1}{2}\cdot \frac{13-1}{2}}(\frac{1}{3})=1 \\
|x|=1, x =\pm 1
$$
有解